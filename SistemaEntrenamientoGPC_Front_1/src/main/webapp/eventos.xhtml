<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="template/template.xhtml">
	<ui:define name="content">
		<div class="main">
			<div class="card">
				<p:messages id="messages" showDetail="true" showIcon="false">
					<p:autoUpdate />
				</p:messages>
				<p:growl id="growl-sticky" for="sticky-key" showDetail="true"
					sticky="true" />
				<h:form id="formEventosEliminar">
					<!-- Calendario -->
					<p:schedule id="schedule" value="#{eventbean.eventModel}"
						widgetVar="myschedule" timeZone="UTC" draggable="false"
						resizable="false" selectable="false" allDaySlot="true"
						aspectRatio="1.5">

						<!-- Cuando seleccionas un evento abre el diálogo -->
						<p:ajax event="eventSelect" listener="#{eventbean.onEventSelect}"
							update=":formEventosEliminar:dialogDetalle"
							oncomplete="PF('dlgDetalle').show()" />
					</p:schedule>

					<!-- Ventanita de detalles -->
					<p:dialog id="dialogDetalle" header="Detalles del Evento"
						widgetVar="dlgDetalle" modal="true" resizable="false"
						closable="true" width="400">

						<h:panelGrid columns="2" cellpadding="5">
							<h:outputText value="Título:" />
							<h:outputText value="#{eventbean.event.title}" />

							<h:outputText value="Descripción:" />
							<h:outputText value="#{eventbean.event.description}" />

							<h:outputText value="Inicio:" />
							<h:outputText value="#{eventbean.event.startDate}" />

							<h:outputText value="Fin:" />
							<h:outputText value="#{eventbean.event.endDate}" />

							<p:commandButton value="Eliminar" rendered="#{eventbean.adminIniciada}"
								action="#{eventbean.eliminarEvento(eventbean.event)}"
								process="@this"
								update=":formEventosEliminar:schedule formEventos"
								oncomplete="PF('dlgDetalle').hide()" icon="pi pi-trash"
								styleClass="ui-button-danger" />


						</h:panelGrid>
					</p:dialog>
				</h:form>

				<h:form id="formEventos" rendered="#{eventbean.adminIniciada}">
					<p:panel header="Registrar Evento">
						<h:panelGrid columns="1" columnClasses="label,value"
							style="width:100%">

							<!-- Nombre del evento -->
							<h:outputLabel for="nombre" value="Nombre:" />
							<p:inputText id="nombre" value="#{eventbean.nombre}"
								required="true" placeholder="Ej: Reunión de equipo" />

							<!-- Fecha del evento -->
							<p:outputLabel for="fecha" value="Fecha" />
							<p:datePicker id="fecha" value="#{eventbean.fecha}"
								showIcon="true" showOnFocus="false" />

							<!-- Descripción -->
							<h:outputLabel for="descripcion" value="Descripción:" />
							<p:inputTextarea id="descripcion"
								value="#{eventbean.descripcion}" rows="3" autoResize="true"
								placeholder="Detalles del evento..." />
						</h:panelGrid>

						<p:separator />

						<!-- Botón Guardar -->
						<p:commandButton value="Guardar"
							action="#{eventbean.agregarEvento}" process="formEventos"
							update=":formEventosEliminar:schedule formEventos"
							icon="pi pi-save" styleClass="ui-button-success" />

					</p:panel>
				</h:form>
			</div>
		</div>
	</ui:define>
</ui:composition>
</html>